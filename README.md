# Generating function solution and inference for nuclear-cytoplasmic mRNA counts in a stochastic gene-expression model

This repository contains the Mathematica and Julia codes and data for the paper: [Joint distribution of nuclear and cytoplasmic mRNA levels in stochastic models of gene expression: analytical results and parameter inference](xx), where the following stochastic gene-expression model is considered

​                                          $$G\xrightleftharpoons[\sigma_\text{on}]{\sigma_\text{off}}G^*,~~~~~~G\xrightarrow{\rho}G+N,~~~~~~N\xRightarrow{\tau}M,~~~~~~M\xrightarrow{d}\varnothing.$$

Nuclear and cytoplasmic mRNAs are denoted by $N$ and $M$ respectively. $G$ and $G^*$ are the active and inactive gene states respectively. For more details, please refer to the aforementioned paper.

**Requirements:**

- Mathematica v13.2.1.0
- Julia v1.9.4
- CSV v0.10.12
- DSP v0.7.9
- DataFrames v1.6.1
- DifferentialEquations v7.12.0
- FastGaussQuadrature v1.0.2
- HypergeometricFunctions v0.3.23
- Interpolations v0.14.7
- KernelDensity v0.6.8
- Optim v1.9.2
- Plots v1.39.0
- StaticArrays v1.9.2
- StatsBase v0.34.

All the codes have been tested on a MacBook Pro with Apple M3 Pro chip (11 cores) and 18 GB RAM.

**File description:**

- `SPAC2H1001_data.csv` and `Rad21_data.csv` store smFISH data for the gene SPAC2H1001 and Rad21 in fission yeasts respecitively, which are comprised of the counts of nuclear and cytoplasmic mRNAs and cell length for each cell. These data are preprocessed from raw data reported in [1].
- `Synthetic_data.csv` contains the synthetic data generated by simulating Model I using SSA.
- `PGF_function.jl` and `FSP_function.jl` include the essential functions for parameter inference based on PGF and FSP, respectively. The FSP inference method is adapted from [2].
- `Main.jl` integrates the aforementioned PGF and FSP methods.
- `taylor_expansion.nb` is the Mathematica code for computing stationary joint distribution of Model I by Taylor expanding the exact generating function solution.

**Reference:**

- [1] D.E. Weidemann, *et al.*[The minimal intrinsic stochasticity of constitutively expressed eukaryotic genes is sub-Poissonian](https://www.science.org/doi/full/10.1126/sciadv.adh5138). *Sci. Adv.* **9**, eadh5138(2023).

- [2] B. Munsky, *et al*. [Distribution shapes govern the discovery of predictive models for gene regulation](https://www.pnas.org/doi/abs/10.1073/pnas.1804060115). *Proc. Natl. Acad. Sci. U S A* **115**, 7533–7538 (2018).

